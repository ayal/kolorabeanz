<head>
  <title>הצעת חוק</title>
  <meta property="og:image" content="https://fbcdn-photos-a.akamaihd.net/photos-ak-snc7/v27562/73/140153199345253/app_1_140153199345253_170.gif" />
  <meta property="og:site_name" content="Peachy"/>
  <meta property="og:description" content="Social Parliament"/>
  <meta property="fb:app_id" content="140153199345253"/>
  <meta property="og:type" content="kolorabim:bill"/>

<script type="text/javascript">

  // Set up a collection to contain player information. On the server,
  // it is backed by a MongoDB collection named "players."
  function getParameterByName(name) {
  
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(window.location.search);
  if(results == null)
  return "";
  else
  return decodeURIComponent(results[1].replace(/\+/g, " "));
  }


  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32699215-1']);
  _gaq.push(['_setCustomVar', 1, 'USER', 'pre-auth-' + (new Date()).getTime(), 2]);
  _gaq.push(['_setCustomVar', 2, 'ref', getParameterByName('ref') || 'noref', 3]);
  _gaq.push(['_setCustomVar', 3, 'pid', getParameterByName('vid') || 'nopid', 3]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

  var bbtimer = {
  start: function(x){
  this[x] = new Date().getTime();
  },
  watch: function(x){
  return (new Date()).getTime() - this[x];
  },
  send: function(x) {
  _gaq.push(['_trackTiming', 'TIME', x, (new Date()).getTime() - this[x], x]);
  _gaq.push(['_trackEvent', 'TIME', x, '' + (new Date()).getTime() - this[x], (new Date()).getTime() - this[x]]);
  }
  };
  
  bbtimer.start('session');
  window.onbeforeunload = function() {
  bbtimer.send('session');
  }
  
  window.onerror = function(){
  _gaq.push(['_trackEvent', 'Errors', 'UNCAUGHT-EXCEPTION', JSON.stringify(arguments), 1]);    
  };
  
</script>

</head>

<body>
{{>layout}}
</body>

<template name="layout">
  <div class="row">
    <div id="myappid" data-placement="left" class="span3 {{valid}}"
 rel="popover" data-content="בכנסת כבר הצביעו.. מה איתך?!" data-original-title="מה דעתך?">
      {{> myapp}}
    </div>
    <div class="span5 {{valid}}">
      {{> binfo}}
      <div class="oknesset">
	<iframe frameborder="0"></iframe>
	<div class="fb-comments" data-href="{{commentsHref}}" data-num-posts="4" data-width="470"></div>
      </div>

    </div>
    <div class="{{sizeOfOthers}}">
      <div class="row">
	{{> others}}
	<div class="fb-activity" style="margin-top:30px" data-site="kolorabim.meteor.com" data-width="300" data-height="301" data-header="true" data-border-color="white" data-recommendations="false"></div>
      </div>
    </div>
  </div>
</template>

<template name="others">
  <div class="others">
    <ul class="nav nav-list">
      <li class="nav-header">
חוקים פעילים אחרים:
      </li>
      {{#each bills}}
      <li class="{{active}}">
        <a href="/?vid={{bill_id}}">
	  <i>
	    <span class="badge badge-info">{{voters}}</span>
	  </i>
	  {{bill_title}}
	</a>
      </li>
      {{/each}}
    </ul>
  </div>
</template>

<template name="binfo">
  <div class="binfo">
    <span class="label label-warning">{{status}}</span>
  </div>
</template>

<template name="myapp">

  <div class="row">
    <div class="span1">
      <input id='voteyes' type="button" class="inc btn btn-success btn-large" value="אני בעד" />
    </div>
    <div class="span1">
      <input id='voteno' type="button" class="inc btn btn-danger btn-large" value="אני נגד" />
    </div>
  </div>

  <div class="row">
    <div class="span1">
      <div class="yesvoters">
	<ul class="thumbnails">
	  {{#each players}}
          {{#if voted 1}}
          {{> player}}
          {{/if}}
	  {{/each}}
	</ul>
      </div>
    </div>

    <div class="span1">
      <div class="novoters">
	<ul class="thumbnails">
	  {{#each players}}
          {{#if voted 0}}
          {{> player}}
          {{/if}}
	  {{/each}}
	</ul>
      </div>
    </div>
  </div>



</template>

<template name="player">
  <li class="span1">
    <div class="thumbnail">
      <img src='https://graph.facebook.com/{{fbid}}/picture'></img>
    </div>
  </li>
</template>
